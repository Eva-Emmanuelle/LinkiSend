<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>LinkiSend â€” Envoyer des cryptos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    :root{
      --bg: #0b0f14;
      --bg-soft:#0f141b;
      --card:#121821;
      --card-2:#0f1620;
      --text:#e6edf3;
      --text-dim:#9fb0c0;
      --stroke:#1f2a37;
      --focus:#334155;
      --shadow: 0 12px 40px rgba(0,0,0,.45);
      --radius:14px;
      --radius-sm:10px;
      --gap:12px;
    }
    *,*:before,*:after{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background:
        radial-gradient(1200px 600px at 20% -10%, #132034 0%, transparent 60%),
        radial-gradient(900px 500px at 110% 0%, #1a2334 0%, transparent 60%),
        var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:420px;margin:40px auto 64px;padding:0 16px;}
    .brand{display:flex;align-items:center;justify-content:center;margin-bottom:18px;position: relative;}
    .brand img.word{max-width: 240px;height: auto;display: block;}
    .brand img.arrow{position:absolute;left:0;top:50%;transform: translateY(-50%);max-width: 60px;height:auto;}
    .card{background:linear-gradient(180deg,var(--card),var(--card-2));border:1px solid var(--stroke);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px 16px;}
    .card h2{margin:4px 2px 2px;font-size:22px;font-weight:750;}
    .sub{color:var(--text-dim);margin:0 2px 14px;font-size:13px;}
    .row{display:flex;gap:var(--gap)}
    .col{flex:1}
    label{display:block;margin:10px 2px 6px;font-size:13px;color:var(--text-dim);}
    select,input{width:100%;height:44px;padding:10px 12px;border-radius:var(--radius-sm);border:1px solid var(--stroke);background:#0e141c;color:#var(--text);outline:none;transition:.15s border,.15s box-shadow,.15s background;}
    select:focus,input:focus{border-color:var(--focus);box-shadow:0 0 0 3px rgba(51,65,85,.35);}
    .hint{font-size:12px;color:var(--text-dim);margin:6px 2px 0}
    .btn{width:100%;height:46px;border:0;border-radius:12px;font-weight:700;font-size:15px;cursor:pointer;background: radial-gradient(circle at 20% 20%, #8b5cf6, #06b6d4, #22c55e);color:#fff;box-shadow:0 10px 24px rgba(34,197,94,.2);transition:transform .06s ease, box-shadow .2s ease, background .12s ease;margin-top:14px;}
    .btn:hover{box-shadow:0 12px 32px rgba(34,197,94,.28)}
    .btn:active{transform:translateY(1px)}
    .wallet-link{display:inline-flex;align-items:center;gap:8px;color:#93c5fd;text-decoration:none;font-weight:600;font-size:14px;padding:8px 10px;border-radius:10px;border:1px dashed var(--stroke);background:#0a1220;margin:8px 2px 4px;width:max-content;}
    .wallet-link:hover{background:#0d1729}
    .result,.error{margin:14px 2px 0;padding:10px 12px;border-radius:10px;font-size:13px;border:1px solid var(--stroke);}
    .error{background:#fee2e2;color:#991b1b;border:1px solid #f87171;}
    .result-cta{margin:14px 2px 0;padding:16px;border-radius:14px;background:#ecfdf5;border:1px solid #bbf7d0;color:#064e3b;display:none;}
    .row-cta{display:flex;gap:10px;align-items:stretch;flex-wrap:wrap}
    .linkbox{flex:1 1 auto;min-width:260px;background:#ffffff;border:1px dashed #a7f3d0;border-radius:10px;padding:12px 14px;display:flex;align-items:center}
    .linkbox code{font-family: ui-monospace, Menlo, Consolas, "Roboto Mono", monospace;font-size:16px;line-height:1.3;color:#065f46;white-space:nowrap;overflow:auto}
    .btn-copy{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700;background:linear-gradient(90deg,#27ae60,#32d36c);color:#fff;box-shadow:0 6px 18px rgba(39,174,96,.25)}
    .btn-copy:active{transform:translateY(1px);filter:brightness(.95)}
    .sub-cta{margin-top:10px;color:#0f5132;font-size:13px;display:flex;gap:8px;align-items:center}
    .toast{position:fixed;right:16px;bottom:16px;background:#10b981;color:white;padding:10px 14px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.25);opacity:0;transform:translateY(6px);transition:opacity .2s,transform .2s;z-index:60;}
    .toast.show{opacity:1;transform:translateY(0)}
    .modal { position:fixed; inset:0; display:none; place-items:center;background:rgba(3,6,12,.6); backdrop-filter:blur(4px); z-index:50; padding:20px; }
    .modal.open{display:grid;}
    .modal-card{width:min(420px,95vw);background:linear-gradient(180deg,var(--card),var(--card-2));border:1px solid var(--stroke);border-radius:16px;box-shadow:var(--shadow);padding:16px;}
    .modal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .modal-head h3{margin:0;font-size:18px}
    .x{appearance:none;border:0;background:transparent;color:var(--text-dim);font-size:22px;cursor:pointer}
    .providers{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px}
    .pv{display:flex;align-items:center;gap:10px;padding:10px;border:1px solid var(--stroke);border-radius:12px;background:#0e141c;color:#text;cursor:pointer;font-weight:600}
    .pv img{width:20px;height:20px}
    .tag{margin-left:auto;font-size:11px;padding:2px 6px;border-radius:999px;background:linear-gradient(90deg,#8b5cf6,#06b6d4,#22c55e);color:#fff;border:0;font-weight:600;}
    .pv:hover{background:#101924}

    /* === indicatif avec drapeaux === */
    .phone-row{display:flex;gap:8px;align-items:center}
    .dial{position:relative;display:flex}
    .dial-btn{height:36px;padding:0 10px;border-radius:8px;border:1px solid var(--stroke);background:#0a1220;color:#e6edf3;display:inline-flex;align-items:center;gap:6px;cursor:pointer;}
    .dial-btn:hover{background:#0d1729}
    .dial-panel{position:absolute;left:0;top:44px;z-index:30;width:300px;background:#0d1420;border:1px solid var(--stroke);border-radius:10px;box-shadow:var(--shadow);display:none;}
    .dial-head{display:flex;align-items:center;gap:6px;padding:8px 10px;border-bottom:1px solid rgba(255,255,255,.06)}
    .dial-search-input{flex:1;height:32px;border:1px solid var(--stroke);background:#0e141c;color:#e6edf3;border-radius:8px;padding:0 8px;outline:none}
    .dial-list{max-height:300px;overflow:auto}
    .dial-item{display:flex;align-items:center;gap:8px;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.04);cursor:pointer}
    .dial-item:last-child{border-bottom:0}
    .flag{font-size:16px}
    .dialcode{color:#cfe1ff}
    .country{color:#9fb0c0;font-size:12px}
  </style>
</head>
<body>
  <script src="config.js"></script>
  <div class="wrap">
    <div class="brand">
      <img src="assets/branding/logo-arrow.svg" alt="FlÃ¨che" class="arrow" />
      <img src="assets/branding/logo-word.svg" alt="LinkiSend" class="word" />
    </div>
    <div class="card">
      <h2>Envoyer des cryptos</h2>
      <p class="sub">GÃ©nÃ¨re un lien en 10&nbsp;secondes.</p>
      <label for="wallet">Ton wallet (expÃ©diteur)</label>
      <input type="text" id="wallet" placeholder="0xABCDEF..." />
      <a href="#" id="connectWalletLink" class="wallet-link">Connecter un wallet</a>

      <div class="row">
        <div class="col">
          <label for="currency">Token</label>
          <select id="currency"><option>USDT</option><option>USDC</option><option>ETH</option></select>
        </div>
        <div class="col">
          <label for="amount">Montant</label>
          <input type="number" id="amount" value="0.01"/>
        </div>
      </div>

      <label for="network">RÃ©seau</label>
      <select id="network"><option>Ethereum</option><option>BNB Chain</option></select>

      <label>NumÃ©ro du destinataire</label>
      <div class="phone-row">
        <div class="dial">
          <button id="dialBtn" class="dial-btn"><span class="flag">ðŸ‡«ðŸ‡·</span><span id="dialCode">+33</span></button>
          <div id="dialPanel" class="dial-panel">
            <div class="dial-head"><input id="dialSearch" class="dial-search-input" placeholder="Rechercher..."/></div>
            <div id="dialList" class="dial-list"></div>
          </div>
        </div>
        <input type="text" id="phone" placeholder="612345678"/>
      </div>

      <button id="generateBtn" class="btn">GÃ©nÃ©rer le lien</button>
      <p class="hint">Aucun transfert tant que le lien nâ€™est pas rÃ©clamÃ©.</p>
      <div id="result" class="result-cta"><code id="the-link"></code></div>
      <div id="error" class="error" style="display:none"></div>
    </div>
  </div>

  <div class="toast" id="toast">Lien copiÃ© âœ…</div>

  <script>
    const BACKEND = (window.LINKISEND_CONFIG && window.LINKISEND_CONFIG.BACKEND_BASE)?window.LINKISEND_CONFIG.BACKEND_BASE:`${location.protocol}//${location.hostname}:8000`;
    const resultDiv=document.getElementById('result'),
          errorDiv=document.getElementById('error'),
          walletInput=document.getElementById('wallet'),
          linkEl=document.getElementById('the-link');

    /* =======================
       DIALS â€” Tous les pays
       ======================= */
    const DIALS = [
      {"flag":"ðŸ‡¦ðŸ‡¨","code":"+247","name":"Ascension Island"},
      {"flag":"ðŸ‡¦ðŸ‡©","code":"+376","name":"Andorre"},
      {"flag":"ðŸ‡¦ðŸ‡ª","code":"+971","name":"Ã‰mirats arabes unis"},
      {"flag":"ðŸ‡¦ðŸ‡«","code":"+93","name":"Afghanistan"},
      {"flag":"ðŸ‡¦ðŸ‡¬","code":"+1268","name":"Antigua-et-Barbuda"},
      {"flag":"ðŸ‡¦ðŸ‡®","code":"+1264","name":"Anguilla"},
      {"flag":"ðŸ‡¦ðŸ‡±","code":"+355","name":"Albanie"},
      {"flag":"ðŸ‡¦ðŸ‡²","code":"+374","name":"ArmÃ©nie"},
      {"flag":"ðŸ‡¦ðŸ‡´","code":"+244","name":"Angola"},
      {"flag":"ðŸ‡¦ðŸ‡¶","code":"+672","name":"Antarctique"},
      {"flag":"ðŸ‡¦ðŸ‡·","code":"+54","name":"Argentine"},
      {"flag":"ðŸ‡¦ðŸ‡¸","code":"+1684","name":"Samoa amÃ©ricaines"},
      {"flag":"ðŸ‡¦ðŸ‡¹","code":"+43","name":"Autriche"},
      {"flag":"ðŸ‡¦ðŸ‡º","code":"+61","name":"Australie"},
      {"flag":"ðŸ‡¦ðŸ‡¼","code":"+297","name":"Aruba"},
      {"flag":"ðŸ‡¦ðŸ‡½","code":"+358","name":"Ã…land"},
      {"flag":"ðŸ‡¦ðŸ‡¿","code":"+994","name":"AzerbaÃ¯djan"},
      {"flag":"ðŸ‡§ðŸ‡¦","code":"+387","name":"Bosnie-HerzÃ©govine"},
      {"flag":"ðŸ‡§ðŸ‡§","code":"+1246","name":"Barbade"},
      {"flag":"ðŸ‡§ðŸ‡©","code":"+880","name":"Bangladesh"},
      {"flag":"ðŸ‡§ðŸ‡ª","code":"+32","name":"Belgique"},
      {"flag":"ðŸ‡§ðŸ‡«","code":"+226","name":"Burkina Faso"},
      {"flag":"ðŸ‡§ðŸ‡¬","code":"+359","name":"Bulgarie"},
      {"flag":"ðŸ‡§ðŸ‡­","code":"+973","name":"BahreÃ¯n"},
      {"flag":"ðŸ‡§ðŸ‡®","code":"+257","name":"Burundi"},
      {"flag":"ðŸ‡§ðŸ‡¯","code":"+229","name":"BÃ©nin"},
      {"flag":"ðŸ‡§ðŸ‡±","code":"+590","name":"Saint-BarthÃ©lemy"},
      {"flag":"ðŸ‡§ðŸ‡²","code":"+1441","name":"Bermudes"},
      {"flag":"ðŸ‡§ðŸ‡³","code":"+673","name":"BrunÃ©i Darussalam"},
      {"flag":"ðŸ‡§ðŸ‡´","code":"+591","name":"Bolivie"},
      {"flag":"ðŸ‡§ðŸ‡¶","code":"+599","name":"Bonaire, Saint-Eustache et Saba"},
      {"flag":"ðŸ‡§ðŸ‡·","code":"+55","name":"BrÃ©sil"},
      {"flag":"ðŸ‡§ðŸ‡¸","code":"+1242","name":"Bahamas"},
      {"flag":"ðŸ‡§ðŸ‡¹","code":"+975","name":"Bhoutan"},
      {"flag":"ðŸ‡§ðŸ‡»","code":"+47","name":"ÃŽle Bouvet"},
      {"flag":"ðŸ‡§ðŸ‡¼","code":"+267","name":"Botswana"},
      {"flag":"ðŸ‡§ðŸ‡¾","code":"+375","name":"BÃ©larus"},
      {"flag":"ðŸ‡§ðŸ‡¿","code":"+501","name":"Belize"},
      {"flag":"ðŸ‡¨ðŸ‡¦","code":"+1","name":"Canada"},
      {"flag":"ðŸ‡¨ðŸ‡¨","code":"+61","name":"ÃŽles Cocos"},
      {"flag":"ðŸ‡¨ðŸ‡©","code":"+243","name":"Congo (RDC)"},
      {"flag":"ðŸ‡¨ðŸ‡«","code":"+236","name":"RÃ©publique centrafricaine"},
      {"flag":"ðŸ‡¨ðŸ‡¬","code":"+242","name":"Congo"},
      {"flag":"ðŸ‡¨ðŸ‡­","code":"+41","name":"Suisse"},
      {"flag":"ðŸ‡¨ðŸ‡®","code":"+225","name":"CÃ´te dâ€™Ivoire"},
      {"flag":"ðŸ‡¨ðŸ‡°","code":"+682","name":"ÃŽles Cook"},
      {"flag":"ðŸ‡¨ðŸ‡±","code":"+56","name":"Chili"},
      {"flag":"ðŸ‡¨ðŸ‡²","code":"+237","name":"Cameroun"},
      {"flag":"ðŸ‡¨ðŸ‡³","code":"+86","name":"Chine"},
      {"flag":"ðŸ‡¨ðŸ‡´","code":"+57","name":"Colombie"},
      {"flag":"ðŸ‡¨ðŸ‡·","code":"+506","name":"Costa Rica"},
      {"flag":"ðŸ‡¨ðŸ‡º","code":"+53","name":"Cuba"},
      {"flag":"ðŸ‡¨ðŸ‡»","code":"+238","name":"Cap-Vert"},
      {"flag":"ðŸ‡¨ðŸ‡¼","code":"+5999","name":"CuraÃ§ao"},
      {"flag":"ðŸ‡¨ðŸ‡½","code":"+61","name":"ÃŽle Christmas"},
      {"flag":"ðŸ‡¨ðŸ‡¾","code":"+357","name":"Chypre"},
      {"flag":"ðŸ‡¨ðŸ‡¿","code":"+420","name":"TchÃ©quie"},
      {"flag":"ðŸ‡©ðŸ‡ª","code":"+49","name":"Allemagne"},
      {"flag":"ðŸ‡©ðŸ‡¯","code":"+253","name":"Djibouti"},
      {"flag":"ðŸ‡©ðŸ‡°","code":"+45","name":"Danemark"},
      {"flag":"ðŸ‡©ðŸ‡²","code":"+1767","name":"Dominique"},
      {"flag":"ðŸ‡©ðŸ‡´","code":"+1809","name":"RÃ©publique dominicaine (809)"},
      {"flag":"ðŸ‡©ðŸ‡´","code":"+1829","name":"RÃ©publique dominicaine (829)"},
      {"flag":"ðŸ‡©ðŸ‡´","code":"+1849","name":"RÃ©publique dominicaine (849)"},
      {"flag":"ðŸ‡©ðŸ‡¿","code":"+213","name":"AlgÃ©rie"},
      {"flag":"ðŸ‡ªðŸ‡¨","code":"+593","name":"Ã‰quateur"},
      {"flag":"ðŸ‡ªðŸ‡ª","code":"+372","name":"Estonie"},
      {"flag":"ðŸ‡ªðŸ‡¬","code":"+20","name":"Ã‰gypte"},
      {"flag":"ðŸ‡ªðŸ‡­","code":"+212","name":"Sahara occidental"},
      {"flag":"ðŸ‡ªðŸ‡·","code":"+291","name":"Ã‰rythrÃ©e"},
      {"flag":"ðŸ‡ªðŸ‡¸","code":"+34","name":"Espagne"},
      {"flag":"ðŸ‡ªðŸ‡¹","code":"+251","name":"Ã‰thiopie"},
      {"flag":"ðŸ‡«ðŸ‡®","code":"+358","name":"Finlande"},
      {"flag":"ðŸ‡«ðŸ‡¯","code":"+679","name":"Fidji"},
      {"flag":"ðŸ‡«ðŸ‡°","code":"+500","name":"ÃŽles Falkland"},
      {"flag":"ðŸ‡«ðŸ‡²","code":"+691","name":"MicronÃ©sie"},
      {"flag":"ðŸ‡«ðŸ‡´","code":"+298","name":"ÃŽles FÃ©roÃ©"},
      {"flag":"ðŸ‡«ðŸ‡·","code":"+33","name":"France"},
      {"flag":"ðŸ‡¬ðŸ‡¦","code":"+241","name":"Gabon"},
      {"flag":"ðŸ‡¬ðŸ‡§","code":"+44","name":"Royaume-Uni"},
      {"flag":"ðŸ‡¬ðŸ‡©","code":"+1473","name":"Grenade"},
      {"flag":"ðŸ‡¬ðŸ‡ª","code":"+995","name":"GÃ©orgie"},
      {"flag":"ðŸ‡¬ðŸ‡«","code":"+594","name":"Guyane franÃ§aise"},
      {"flag":"ðŸ‡¬ðŸ‡¬","code":"+44","name":"Guernesey"},
      {"flag":"ðŸ‡¬ðŸ‡­","code":"+233","name":"Ghana"},
      {"flag":"ðŸ‡¬ðŸ‡®","code":"+350","name":"Gibraltar"},
      {"flag":"ðŸ‡¬ðŸ‡±","code":"+299","name":"Groenland"},
      {"flag":"ðŸ‡¬ðŸ‡²","code":"+220","name":"Gambie"},
      {"flag":"ðŸ‡¬ðŸ‡³","code":"+224","name":"GuinÃ©e"},
      {"flag":"ðŸ‡¬ðŸ‡µ","code":"+590","name":"Guadeloupe"},
      {"flag":"ðŸ‡¬ðŸ‡¶","code":"+240","name":"GuinÃ©e Ã©quatoriale"},
      {"flag":"ðŸ‡¬ðŸ‡·","code":"+30","name":"GrÃ¨ce"},
      {"flag":"ðŸ‡¬ðŸ‡¹","code":"+502","name":"Guatemala"},
      {"flag":"ðŸ‡¬ðŸ‡º","code":"+1671","name":"Guam"},
      {"flag":"ðŸ‡¬ðŸ‡¼","code":"+245","name":"GuinÃ©e-Bissau"},
      {"flag":"ðŸ‡¬ðŸ‡¾","code":"+592","name":"Guyana"},
      {"flag":"ðŸ‡­ðŸ‡°","code":"+852","name":"Hong Kong"},
      {"flag":"ðŸ‡­ðŸ‡²","code":"+672","name":"Heard-et-MacDonald"},
      {"flag":"ðŸ‡­ðŸ‡³","code":"+504","name":"Honduras"},
      {"flag":"ðŸ‡­ðŸ‡·","code":"+385","name":"Croatie"},
      {"flag":"ðŸ‡­ðŸ‡¹","code":"+509","name":"HaÃ¯ti"},
      {"flag":"ðŸ‡­ðŸ‡º","code":"+36","name":"Hongrie"},
      {"flag":"ðŸ‡®ðŸ‡©","code":"+62","name":"IndonÃ©sie"},
      {"flag":"ðŸ‡®ðŸ‡ª","code":"+353","name":"Irlande"},
      {"flag":"ðŸ‡®ðŸ‡±","code":"+972","name":"IsraÃ«l"},
      {"flag":"ðŸ‡®ðŸ‡²","code":"+44","name":"ÃŽle de Man"},
      {"flag":"ðŸ‡®ðŸ‡³","code":"+91","name":"Inde"},
      {"flag":"ðŸ‡®ðŸ‡´","code":"+246","name":"Territoire britannique de lâ€™ocÃ©an Indien"},
      {"flag":"ðŸ‡®ðŸ‡¶","code":"+964","name":"Irak"},
      {"flag":"ðŸ‡®ðŸ‡·","code":"+98","name":"Iran"},
      {"flag":"ðŸ‡®ðŸ‡¸","code":"+354","name":"Islande"},
      {"flag":"ðŸ‡®ðŸ‡¹","code":"+39","name":"Italie"},
      {"flag":"ðŸ‡¯ðŸ‡ª","code":"+44","name":"Jersey"},
      {"flag":"ðŸ‡¯ðŸ‡²","code":"+1876","name":"JamaÃ¯que"},
      {"flag":"ðŸ‡¯ðŸ‡´","code":"+962","name":"Jordanie"},
      {"flag":"ðŸ‡¯ðŸ‡µ","code":"+81","name":"Japon"},
      {"flag":"ðŸ‡°ðŸ‡ª","code":"+254","name":"Kenya"},
      {"flag":"ðŸ‡°ðŸ‡¬","code":"+996","name":"Kirghizistan"},
      {"flag":"ðŸ‡°ðŸ‡­","code":"+855","name":"Cambodge"},
      {"flag":"ðŸ‡°ðŸ‡®","code":"+686","name":"Kiribati"},
      {"flag":"ðŸ‡°ðŸ‡²","code":"+269","name":"Comores"},
      {"flag":"ðŸ‡°ðŸ‡³","code":"+1869","name":"Saint-Kitts-et-Nevis"},
      {"flag":"ðŸ‡°ðŸ‡µ","code":"+850","name":"CorÃ©e du Nord"},
      {"flag":"ðŸ‡°ðŸ‡·","code":"+82","name":"CorÃ©e du Sud"},
      {"flag":"ðŸ‡°ðŸ‡¼","code":"+965","name":"KoweÃ¯t"},
      {"flag":"ðŸ‡°ðŸ‡¾","code":"+1345","name":"ÃŽles CaÃ¯mans"},
      {"flag":"ðŸ‡°ðŸ‡¿","code":"+7","name":"Kazakhstan"},
      {"flag":"ðŸ‡±ðŸ‡¦","code":"+856","name":"Laos"},
      {"flag":"ðŸ‡±ðŸ‡§","code":"+961","name":"Liban"},
      {"flag":"ðŸ‡±ðŸ‡¨","code":"+1758","name":"Sainte-Lucie"},
      {"flag":"ðŸ‡±ðŸ‡®","code":"+423","name":"Liechtenstein"},
      {"flag":"ðŸ‡±ðŸ‡°","code":"+94","name":"Sri Lanka"},
      {"flag":"ðŸ‡±ðŸ‡·","code":"+231","name":"LibÃ©ria"},
      {"flag":"ðŸ‡±ðŸ‡¸","code":"+266","name":"Lesotho"},
      {"flag":"ðŸ‡±ðŸ‡¹","code":"+370","name":"Lituanie"},
      {"flag":"ðŸ‡±ðŸ‡º","code":"+352","name":"Luxembourg"},
      {"flag":"ðŸ‡±ðŸ‡»","code":"+371","name":"Lettonie"},
      {"flag":"ðŸ‡±ðŸ‡¾","code":"+218","name":"Libye"},
      {"flag":"ðŸ‡²ðŸ‡¦","code":"+212","name":"Maroc"},
      {"flag":"ðŸ‡²ðŸ‡¨","code":"+377","name":"Monaco"},
      {"flag":"ðŸ‡²ðŸ‡©","code":"+373","name":"Moldavie"},
      {"flag":"ðŸ‡²ðŸ‡ª","code":"+382","name":"MontÃ©nÃ©gro"},
      {"flag":"ðŸ‡²ðŸ‡«","code":"+590","name":"Saint-Martin"},
      {"flag":"ðŸ‡²ðŸ‡¬","code":"+261","name":"Madagascar"},
      {"flag":"ðŸ‡²ðŸ‡­","code":"+692","name":"ÃŽles Marshall"},
      {"flag":"ðŸ‡²ðŸ‡°","code":"+389","name":"MacÃ©doine du Nord"},
      {"flag":"ðŸ‡²ðŸ‡±","code":"+223","name":"Mali"},
      {"flag":"ðŸ‡²ðŸ‡²","code":"+95","name":"Myanmar"},
      {"flag":"ðŸ‡²ðŸ‡³","code":"+976","name":"Mongolie"},
      {"flag":"ðŸ‡²ðŸ‡´","code":"+853","name":"Macao"},
      {"flag":"ðŸ‡²ðŸ‡µ","code":"+1670","name":"Mariannes du Nord"},
      {"flag":"ðŸ‡²ðŸ‡¶","code":"+596","name":"Martinique"},
      {"flag":"ðŸ‡²ðŸ‡·","code":"+222","name":"Mauritanie"},
      {"flag":"ðŸ‡²ðŸ‡¸","code":"+1664","name":"Montserrat"},
      {"flag":"ðŸ‡²ðŸ‡¹","code":"+356","name":"Malte"},
      {"flag":"ðŸ‡²ðŸ‡º","code":"+230","name":"Maurice"},
      {"flag":"ðŸ‡²ðŸ‡»","code":"+960","name":"Maldives"},
      {"flag":"ðŸ‡²ðŸ‡¼","code":"+265","name":"Malawi"},
      {"flag":"ðŸ‡²ðŸ‡½","code":"+52","name":"Mexique"},
      {"flag":"ðŸ‡²ðŸ‡¾","code":"+60","name":"Malaisie"},
      {"flag":"ðŸ‡²ðŸ‡¿","code":"+258","name":"Mozambique"},
      {"flag":"ðŸ‡³ðŸ‡¦","code":"+264","name":"Namibie"},
      {"flag":"ðŸ‡³ðŸ‡¨","code":"+687","name":"Nouvelle-CalÃ©donie"},
      {"flag":"ðŸ‡³ðŸ‡ª","code":"+227","name":"Niger"},
      {"flag":"ðŸ‡³ðŸ‡«","code":"+672","name":"ÃŽle Norfolk"},
      {"flag":"ðŸ‡³ðŸ‡¬","code":"+234","name":"NigÃ©ria"},
      {"flag":"ðŸ‡³ðŸ‡®","code":"+505","name":"Nicaragua"},
      {"flag":"ðŸ‡³ðŸ‡±","code":"+31","name":"Pays-Bas"},
      {"flag":"ðŸ‡³ðŸ‡´","code":"+47","name":"NorvÃ¨ge"},
      {"flag":"ðŸ‡³ðŸ‡µ","code":"+977","name":"NÃ©pal"},
      {"flag":"ðŸ‡³ðŸ‡·","code":"+674","name":"Nauru"},
      {"flag":"ðŸ‡³ðŸ‡¿","code":"+64","name":"Nouvelle-ZÃ©lande"},
      {"flag":"ðŸ‡´ðŸ‡²","code":"+968","name":"Oman"},
      {"flag":"ðŸ‡µðŸ‡¦","code":"+507","name":"Panama"},
      {"flag":"ðŸ‡µðŸ‡ª","code":"+51","name":"PÃ©rou"},
      {"flag":"ðŸ‡µðŸ‡«","code":"+689","name":"PolynÃ©sie franÃ§aise"},
      {"flag":"ðŸ‡µðŸ‡¬","code":"+675","name":"Papouasie-Nouvelle-GuinÃ©e"},
      {"flag":"ðŸ‡µðŸ‡­","code":"+63","name":"Philippines"},
      {"flag":"ðŸ‡µðŸ‡°","code":"+92","name":"Pakistan"},
      {"flag":"ðŸ‡µðŸ‡±","code":"+48","name":"Pologne"},
      {"flag":"ðŸ‡µðŸ‡²","code":"+508","name":"Saint-Pierre-et-Miquelon"},
      {"flag":"ðŸ‡µðŸ‡³","code":"+64","name":"Pitcairn"},
      {"flag":"ðŸ‡µðŸ‡·","code":"+1787","name":"Porto Rico (787)"},
      {"flag":"ðŸ‡µðŸ‡·","code":"+1939","name":"Porto Rico (939)"},
      {"flag":"ðŸ‡µðŸ‡¸","code":"+970","name":"Palestine"},
      {"flag":"ðŸ‡µðŸ‡¹","code":"+351","name":"Portugal"},
      {"flag":"ðŸ‡µðŸ‡¼","code":"+680","name":"Palaos"},
      {"flag":"ðŸ‡µðŸ‡¾","code":"+595","name":"Paraguay"},
      {"flag":"ðŸ‡¶ðŸ‡¦","code":"+974","name":"Qatar"},
      {"flag":"ðŸ‡·ðŸ‡ª","code":"+262","name":"La RÃ©union"},
      {"flag":"ðŸ‡·ðŸ‡´","code":"+40","name":"Roumanie"},
      {"flag":"ðŸ‡·ðŸ‡¸","code":"+381","name":"Serbie"},
      {"flag":"ðŸ‡·ðŸ‡º","code":"+7","name":"Russie"},
      {"flag":"ðŸ‡·ðŸ‡¼","code":"+250","name":"Rwanda"},
      {"flag":"ðŸ‡¸ðŸ‡¦","code":"+966","name":"Arabie saoudite"},
      {"flag":"ðŸ‡¸ðŸ‡§","code":"+677","name":"ÃŽles Salomon"},
      {"flag":"ðŸ‡¸ðŸ‡¨","code":"+248","name":"Seychelles"},
      {"flag":"ðŸ‡¸ðŸ‡©","code":"+249","name":"Soudan"},
      {"flag":"ðŸ‡¸ðŸ‡ª","code":"+46","name":"SuÃ¨de"},
      {"flag":"ðŸ‡¸ðŸ‡¬","code":"+65","name":"Singapour"},
      {"flag":"ðŸ‡¸ðŸ‡­","code":"+290","name":"Sainte-HÃ©lÃ¨ne"},
      {"flag":"ðŸ‡¸ðŸ‡®","code":"+386","name":"SlovÃ©nie"},
      {"flag":"ðŸ‡¸ðŸ‡¯","code":"+47","name":"Svalbard et Jan Mayen"},
      {"flag":"ðŸ‡¸ðŸ‡°","code":"+421","name":"Slovaquie"},
      {"flag":"ðŸ‡¸ðŸ‡±","code":"+232","name":"Sierra Leone"},
      {"flag":"ðŸ‡¸ðŸ‡²","code":"+378","name":"Saint-Marin"},
      {"flag":"ðŸ‡¸ðŸ‡³","code":"+221","name":"SÃ©nÃ©gal"},
      {"flag":"ðŸ‡¸ðŸ‡´","code":"+252","name":"Somalie"},
      {"flag":"ðŸ‡¸ðŸ‡·","code":"+597","name":"Suriname"},
      {"flag":"ðŸ‡¸ðŸ‡¸","code":"+211","name":"Soudan du Sud"},
      {"flag":"ðŸ‡¸ðŸ‡¹","code":"+239","name":"Sao TomÃ©-et-Principe"},
      {"flag":"ðŸ‡¸ðŸ‡»","code":"+503","name":"Salvador"},
      {"flag":"ðŸ‡¸ðŸ‡½","code":"+1721","name":"Sint Maarten"},
      {"flag":"ðŸ‡¸ðŸ‡¾","code":"+963","name":"Syrie"},
      {"flag":"ðŸ‡¸ðŸ‡¿","code":"+268","name":"Eswatini"},
      {"flag":"ðŸ‡¹ðŸ‡¦","code":"+290","name":"Tristan da Cunha"},
      {"flag":"ðŸ‡¹ðŸ‡¨","code":"+1649","name":"ÃŽles Turques-et-CaÃ¯ques"},
      {"flag":"ðŸ‡¹ðŸ‡©","code":"+235","name":"Tchad"},
      {"flag":"ðŸ‡¹ðŸ‡¬","code":"+228","name":"Togo"},
      {"flag":"ðŸ‡¹ðŸ‡­","code":"+66","name":"ThaÃ¯lande"},
      {"flag":"ðŸ‡¹ðŸ‡¯","code":"+992","name":"Tadjikistan"},
      {"flag":"ðŸ‡¹ðŸ‡°","code":"+690","name":"Tokelau"},
      {"flag":"ðŸ‡¹ðŸ‡±","code":"+670","name":"Timor oriental"},
      {"flag":"ðŸ‡¹ðŸ‡²","code":"+993","name":"TurkmÃ©nistan"},
      {"flag":"ðŸ‡¹ðŸ‡³","code":"+216","name":"Tunisie"},
      {"flag":"ðŸ‡¹ðŸ‡´","code":"+676","name":"Tonga"},
      {"flag":"ðŸ‡¹ðŸ‡·","code":"+90","name":"Turquie"},
      {"flag":"ðŸ‡¹ðŸ‡¹","code":"+1868","name":"TrinitÃ©-et-Tobago"},
      {"flag":"ðŸ‡¹ðŸ‡»","code":"+688","name":"Tuvalu"},
      {"flag":"ðŸ‡¹ðŸ‡¼","code":"+886","name":"TaÃ¯wan"},
      {"flag":"ðŸ‡¹ðŸ‡¿","code":"+255","name":"Tanzanie"},
      {"flag":"ðŸ‡ºðŸ‡¦","code":"+380","name":"Ukraine"},
      {"flag":"ðŸ‡ºðŸ‡¬","code":"+256","name":"Ouganda"},
      {"flag":"ðŸ‡ºðŸ‡²","code":"+1","name":"ÃŽles mineures Ã©loignÃ©es des Ã‰tats-Unis"},
      {"flag":"ðŸ‡ºðŸ‡³","code":"+1","name":"Nations Unies"},
      {"flag":"ðŸ‡ºðŸ‡¸","code":"+1","name":"Ã‰tats-Unis"},
      {"flag":"ðŸ‡ºðŸ‡¾","code":"+598","name":"Uruguay"},
      {"flag":"ðŸ‡ºðŸ‡¿","code":"+998","name":"OuzbÃ©kistan"},
      {"flag":"ðŸ‡»ðŸ‡¦","code":"+379","name":"Vatican"},
      {"flag":"ðŸ‡»ðŸ‡¨","code":"+1784","name":"Saint-Vincent-et-les-Grenadines"},
      {"flag":"ðŸ‡»ðŸ‡ª","code":"+58","name":"Venezuela"},
      {"flag":"ðŸ‡»ðŸ‡¬","code":"+1284","name":"ÃŽles Vierges britanniques"},
      {"flag":"ðŸ‡»ðŸ‡®","code":"+1340","name":"ÃŽles Vierges des Ã‰tats-Unis"},
      {"flag":"ðŸ‡»ðŸ‡³","code":"+84","name":"ViÃªt Nam"},
      {"flag":"ðŸ‡»ðŸ‡º","code":"+678","name":"Vanuatu"},
      {"flag":"ðŸ‡¼ðŸ‡«","code":"+681","name":"Wallis-et-Futuna"},
      {"flag":"ðŸ‡¼ðŸ‡¸","code":"+685","name":"Samoa"},
      {"flag":"ðŸ‡½ðŸ‡°","code":"+383","name":"Kosovo"},
      {"flag":"ðŸ‡¾ðŸ‡ª","code":"+967","name":"YÃ©men"},
      {"flag":"ðŸ‡¾ðŸ‡¹","code":"+262","name":"Mayotte"},
      {"flag":"ðŸ‡¿ðŸ‡¦","code":"+27","name":"Afrique du Sud"},
      {"flag":"ðŸ‡¿ðŸ‡²","code":"+260","name":"Zambie"},
      {"flag":"ðŸ‡¿ðŸ‡¼","code":"+263","name":"Zimbabwe"}
    ];

    const dialBtn=document.getElementById('dialBtn'),
          dialPanel=document.getElementById('dialPanel'),
          dialSearch=document.getElementById('dialSearch'),
          dialList=document.getElementById('dialList');

    let currentDial={flag:"ðŸ‡«ðŸ‡·",code:"+33"};

    function renderDialList(f=""){
      const q=(f||"").trim().toLowerCase();
      dialList.innerHTML="";
      DIALS.filter(d=>!q||d.name.toLowerCase().includes(q)||d.code.includes(q)).forEach(d=>{
        const row=document.createElement("div");
        row.className="dial-item";
        row.innerHTML=`<span class="flag">${d.flag}</span><span class="dialcode">${d.code}</span><span class="country">${d.name}</span>`;
        row.onclick=()=>{
          currentDial={flag:d.flag,code:d.code};
          dialBtn.innerHTML=`<span class="flag">${d.flag}</span><span id="dialCode">${d.code}</span>`;
          dialPanel.style.display="none";
        };
        dialList.appendChild(row);
      });
    }

    dialBtn.onclick=(e)=>{
      e.stopPropagation(); // Ã©vite la fermeture immÃ©diate par le listener global
      const open = dialPanel.style.display==="block";
      dialPanel.style.display = open ? "none" : "block";
      if(!open){ dialSearch.value=""; renderDialList(""); setTimeout(()=>dialSearch.focus(),0); }
    };
    dialSearch.oninput=()=>renderDialList(dialSearch.value);

    // âœ… Correction: on ferme seulement si clic en dehors du panneau ET du bouton
    document.addEventListener("click",(e)=>{
      if(!dialPanel.contains(e.target) && !dialBtn.contains(e.target)){
        dialPanel.style.display="none";
      }
    });

    // GÃ©nÃ©ration du lien (inchangÃ©)
    document.getElementById('generateBtn').onclick=async()=>{
      const amount=parseFloat(document.getElementById('amount').value),
            currency=document.getElementById('currency').value,
            sender_wallet=walletInput.value.trim(),
            localPhone=document.getElementById('phone').value.trim(),
            recipient_phone=`${currentDial.code}${localPhone}`,
            network=document.getElementById('network').value;

      resultDiv.style.display='none';
      errorDiv.style.display='none';

      if(!amount||!currency||!sender_wallet||!localPhone||!network){
        errorDiv.textContent="Merci de remplir tous les champs.";
        errorDiv.style.display='block';
        return;
      }
      try{
        const res=await fetch(`${BACKEND}/create-link`,{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({amount,currency,sender_wallet,recipient_phone,network})
        });
        const data=await res.json();
        if(!res.ok) throw new Error(data.detail||"Erreur");
        const lien=`https://linkisend.io/${data.short_id}`;
        linkEl.textContent=lien;
        resultDiv.style.display='block';
      }catch(err){
        errorDiv.textContent=err.message;
        errorDiv.style.display='block';
      }
    };
  </script>
</body>
</html>
