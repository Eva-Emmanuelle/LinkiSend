<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LinkiSend ‚Äî Send crypto</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    :root{
      --bg:#0b0f14;--bg-soft:#0f141b;--card:#121821;--card-2:#0f1620;
      --text:#e6edf3;--text-dim:#9fb0c0;--stroke:#1f2a37;--focus:#334155;
      --shadow:0 12px 40px rgba(0,0,0,.45);--radius:14px;--radius-sm:10px;--gap:12px;
    }
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:
      radial-gradient(1200px 600px at 20% -10%, #132034 0%, transparent 60%),
      radial-gradient(900px 500px at 110% 0%, #1a2334 0%, transparent 60%),var(--bg);
      color:var(--text);}
    .wrap{max-width:420px;margin:40px auto 64px;padding:0 16px;}
    .brand{display:flex;align-items:center;justify-content:center;margin-bottom:18px;position:relative}
    .brand img.word{max-width:240px;height:auto}
    .brand img.arrow{position:absolute;left:0;top:50%;transform:translateY(-50%);max-width:60px}
    .card{background:linear-gradient(180deg,var(--card),var(--card-2));border:1px solid var(--stroke);
      border-radius:var(--radius);box-shadow:var(--shadow);padding:18px 16px}
    .card h2{margin:4px 2px 2px;font-size:22px;font-weight:750}
    .sub{color:var(--text-dim);margin:0 2px 14px;font-size:13px}
    label{display:block;margin:10px 2px 6px;font-size:13px;color:var(--text-dim)}
    input,select{width:100%;height:44px;padding:10px 12px;border-radius:var(--radius-sm);border:1px solid var(--stroke);
      background:#0e141c;color:var(--text)}
    .btn{width:100%;height:46px;border:0;border-radius:12px;font-weight:700;font-size:15px;cursor:pointer;
      background: radial-gradient(circle at 20% 20%, #8b5cf6,#06b6d4,#22c55e);color:#fff;box-shadow:0 10px 24px rgba(34,197,94,.2);margin-top:14px}
    .wallet-link{display:inline-flex;align-items:center;gap:8px;color:#93c5fd;text-decoration:none;font-weight:600;
      font-size:14px;padding:8px 10px;border-radius:10px;border:1px dashed var(--stroke);background:#0a1220;margin:8px 2px 4px;width:max-content}
    .error{background:#fee2e2;color:#991b1b;border:1px solid #f87171;margin-top:10px;padding:10px;border-radius:10px;display:none}
    .result-cta{margin:14px 2px 0;padding:16px;border-radius:14px;background:#ecfdf5;border:1px solid #bbf7d0;color:#064e3b;display:none}
    .linkbox{flex:1;background:#fff;border:1px dashed #a7f3d0;border-radius:10px;padding:12px}
    .phone-row{display:flex;gap:8px;align-items:center}
    .dial{position:relative}
    .dial-btn{height:36px;padding:0 10px;border-radius:8px;border:1px solid var(--stroke);background:#0a1220;
      display:inline-flex;align-items:center;gap:6px;color:#e6edf3;cursor:pointer}
    .dial-panel{position:absolute;top:44px;left:0;z-index:30;width:260px;background:#0d1420;border:1px solid var(--stroke);
      border-radius:10px;display:none;max-height:300px;overflow:auto}
    .dial-head{padding:6px}
    .dial-search-input{width:100%;padding:6px;border-radius:6px;border:1px solid var(--stroke);background:#0e141c;color:#fff}
    .dial-item{padding:8px 10px;display:flex;align-items:center;gap:8px;cursor:pointer}
    .dial-item:hover{background:#1f2a37}
    .flag{font-size:16px}
    .lang-switch{position:absolute;top:10px;right:10px;cursor:pointer;font-size:20px}
  </style>
</head>
<body>
  <script src="config.js"></script>
  <div class="wrap">
    <div class="brand">
      <img src="assets/branding/logo-arrow.svg" class="arrow"/>
      <img src="assets/branding/logo-word.svg" class="word"/>
      <div id="langSwitch" class="lang-switch">üåê</div>
    </div>
    <div class="card">
      <h2 id="t-title"></h2>
      <p class="sub" id="t-sub"></p>

      <label for="wallet" id="t-wallet"></label>
      <input id="wallet" placeholder="0xABCDEF..."/>
      <a href="#" id="connectWalletLink" class="wallet-link"></a>

      <label id="t-token"></label>
      <select id="currency"><option>USDT</option><option>USDC</option><option>ETH</option></select>

      <label id="t-amount"></label>
      <input id="amount" type="number" placeholder="0.01"/>

      <label id="t-network"></label>
      <select id="network"><option>Ethereum</option><option>BNB Chain</option></select>

      <label id="t-phone"></label>
      <div class="phone-row">
        <div class="dial">
          <button id="dialBtn" class="dial-btn"><span class="flag">üá´üá∑</span><span id="dialCode">+33</span></button>
          <div id="dialPanel" class="dial-panel">
            <div class="dial-head"><input id="dialSearch" class="dial-search-input" placeholder="Search..."/></div>
            <div id="dialList"></div>
          </div>
        </div>
        <input id="phone" placeholder="612345678"/>
      </div>

      <button id="generateBtn" class="btn"></button>
      <p class="sub" id="t-hint"></p>
      <div id="result" class="result-cta"><code id="the-link"></code></div>
      <div id="error" class="error"></div>
    </div>
  </div>

  <script>
    // ===== translations =====
    const translations={
      en:{title:"Send crypto",sub:"Generate a link in 10 seconds.",wallet:"Your wallet (sender)",connect:"Connect a wallet",token:"Token",amount:"Amount (crypto)",network:"Network",phone:"Recipient phone number",generate:"Generate link",hint:"No on-chain transfer until the link is claimed.",error:"Please fill in all required fields."},
      fr:{title:"Envoyer des cryptos",sub:"G√©n√®re un lien en 10 secondes.",wallet:"Ton wallet (exp√©diteur)",connect:"Connecter un wallet",token:"Token",amount:"Montant (crypto)",network:"R√©seau",phone:"Num√©ro du destinataire",generate:"G√©n√©rer le lien",hint:"Aucun transfert on-chain n‚Äôest effectu√© tant que le lien n‚Äôest pas r√©clam√©.",error:"Merci de remplir tous les champs."}
    };
    let lang=localStorage.getItem("lang")||"en";
    function applyLang(){
      const t=translations[lang];
      document.getElementById("t-title").textContent=t.title;
      document.getElementById("t-sub").textContent=t.sub;
      document.getElementById("t-wallet").textContent=t.wallet;
      document.getElementById("connectWalletLink").textContent=t.connect;
      document.getElementById("t-token").textContent=t.token;
      document.getElementById("t-amount").textContent=t.amount;
      document.getElementById("t-network").textContent=t.network;
      document.getElementById("t-phone").textContent=t.phone;
      document.getElementById("generateBtn").textContent=t.generate;
      document.getElementById("t-hint").textContent=t.hint;
    }
    document.getElementById("langSwitch").onclick=()=>{lang=(lang==="en"?"fr":"en");localStorage.setItem("lang",lang);applyLang();};
    applyLang();

    // ===== dials full (sample subset for demo, to expand) =====
    const DIALS=[{flag:"üá´üá∑",code:"+33",name:"France"},{flag:"üá∫üá∏",code:"+1",name:"United States"},{flag:"üá¨üáß",code:"+44",name:"United Kingdom"},{flag:"üá™üá∏",code:"+34",name:"Spain"},{flag:"üáÆüáπ",code:"+39",name:"Italy"},{flag:"üá©üá™",code:"+49",name:"Germany"},{flag:"üáØüáµ",code:"+81",name:"Japan"},{flag:"üá®üá¶",code:"+1",name:"Canada"},{flag:"üáßüá∑",code:"+55",name:"Brazil"}];
    const dialBtn=document.getElementById("dialBtn"),dialPanel=document.getElementById("dialPanel"),dialSearch=document.getElementById("dialSearch"),dialList=document.getElementById("dialList");let currentDial=DIALS[0];
    function renderDialList(f=""){dialList.innerHTML="";DIALS.filter(d=>!f||d.name.toLowerCase().includes(f)||d.code.includes(f)).forEach(d=>{const row=document.createElement("div");row.className="dial-item";row.innerHTML=`<span class="flag">${d.flag}</span><span>${d.code}</span><span class="country">${d.name}</span>`;row.onclick=()=>{currentDial=d;dialBtn.innerHTML=`<span class="flag">${d.flag}</span><span>${d.code}</span>`;dialPanel.style.display="none"};dialList.appendChild(row);});}
    dialBtn.onclick=()=>{dialPanel.style.display=dialPanel.style.display==="block"?"none":"block";renderDialList("");dialSearch.value="";};
    dialSearch.oninput=()=>renderDialList(dialSearch.value.toLowerCase());
    document.addEventListener("click",e=>{if(!dialPanel.contains(e.target)&&e.target!==dialBtn)dialPanel.style.display="none";});

    // ===== generate link (backend integration unchanged) =====
    const BACKEND=(window.LINKISEND_CONFIG&&window.LINKISEND_CONFIG.BACKEND_BASE)?window.LINKISEND_CONFIG.BACKEND_BASE:`${location.protocol}//${location.hostname}:8000`;
    document.getElementById("generateBtn").onclick=async()=>{const amount=parseFloat(document.getElementById("amount").value),currency=document.getElementById("currency").value,sender_wallet=document.getElementById("wallet").value.trim(),localPhone=document.getElementById("phone").value.trim(),recipient_phone=`${currentDial.code}${localPhone}`,network=document.getElementById("network").value;const errorDiv=document.getElementById("error"),resultDiv=document.getElementById("result"),linkEl=document.getElementById("the-link");errorDiv.style.display="none";resultDiv.style.display="none";if(!amount||!currency||!sender_wallet||!localPhone||!network){errorDiv.textContent=translations[lang].error;errorDiv.style.display="block";return;}try{const res=await fetch(`${BACKEND}/create-link`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount,currency,sender_wallet,recipient_phone,network})});const data=await res.json();if(!res.ok)throw new Error(data.detail||"Error");const lien=`https://linkisend.io/${data.short_id}`;linkEl.textContent=lien;resultDiv.style.display="block";}catch(err){errorDiv.textContent=err.message;errorDiv.style.display="block";}};
  </script>
</body>
</html>
